<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neon Grid: Drag & Drop</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <header id="top-panel">
        <div id="system-msg">系统就绪 - 点击建筑按钮放置</div>
        <div class="stats-group">
            <div class="stat-item" id="peak-hour-indicator" style="display: none;">
                <span class="stat-label">⚡ 用电高峰</span>
                <span class="stat-value" style="color: #ff6600;">+50%</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">🕐 时间</span>
                <span class="stat-value" id="time-display">00:00</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">资金</span>
                <span class="stat-value" id="money-display" style="color: #ffd700;">$200</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">收入</span>
                <span class="stat-value" id="income-display">+$0/s</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">覆盖</span>
                <span class="stat-value" id="coverage-display">0%</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">人口</span>
                <span class="stat-value" id="scale-display">0</span>
            </div>
        </div>
    </header>

    <div id="game-container">
        <div id="alarm-overlay"></div>




        <!-- 视图控制按钮 -->
        <div class="view-controls">
            <button class="view-btn" id="zoom-in-btn" title="放大">+</button>
            <button class="view-btn" id="zoom-out-btn" title="缩小">-</button>
            <button class="view-btn" id="reset-view-btn" title="重置视图">⊙</button>
            <button class="view-btn" id="fullscreen-btn" title="全屏">⛶</button>
        </div>

        <!-- 帮助提示 -->
        <div id="help-tip" class="help-tip"></div>

        <div id="game-over">
            <h2 id="game-over-title">系统故障 | SYSTEM FAILURE</h2>
            <p id="game-over-reason" style="color: #88aaff; text-align: center; padding: 0 20px;">电网过载检测。</p>
            <div id="replay-container" style="margin: 20px 0; border: 2px solid #334444; background: #000; position: relative;">
                <div style="position: absolute; top: 10px; left: 10px; color: #00ffff; font-size: 12px; background: rgba(0,0,0,0.5); padding: 2px 5px;">时间回放</div>
                <canvas id="replayCanvas" width="400" height="250"></canvas>
            </div>
            <div class="slider-container" style="width: 400px; margin: 10px 0; display: flex; align-items: center; gap: 10px;">
                <input type="range" id="replay-slider" min="0" max="100" value="0" style="-webkit-appearance: none; width: 100%; height: 6px; background: #334455; outline: none; border-radius: 3px;">
            </div>
            <button class="restart-btn" onclick="restartGame()">重启系统</button>
        </div>

        <!-- 难度选择弹窗 -->
        <div id="difficulty-modal">
            <h2>🎮 选择游戏难度</h2>
            <div class="difficulty-options">
                <button class="difficulty-btn beginner" onclick="selectDifficulty('beginner')">
                    <span class="difficulty-name">🌱 新手</span>
                    <span class="difficulty-desc">初始资金+50%<br>高峰频率-50%<br>故障概率-50%</span>
                </button>
                <button class="difficulty-btn normal" onclick="selectDifficulty('normal')">
                    <span class="difficulty-name">⚡ 普通</span>
                    <span class="difficulty-desc">标准游戏体验<br>平衡的游戏参数</span>
                </button>
                <button class="difficulty-btn expert" onclick="selectDifficulty('expert')">
                    <span class="difficulty-name">🔥 专家</span>
                    <span class="difficulty-desc">初始资金-30%<br>高峰频率+50%<br>故障概率+50%</span>
                </button>
            </div>
        </div>

        <canvas id="gameCanvas"></canvas>
    </div>

    <footer id="bottom-panel">
        <div class="buildings-toolbar">
            <div class="building-btn" data-type="plant">
                <span class="icon">🏭</span>
                <span class="label">电厂</span>
                <span class="price">$1500</span>
            </div>
            <div class="building-btn nuclear" data-type="nuclear">
                <span class="icon">☢️</span>
                <span class="label">核电站</span>
                <span class="price">$6000</span>
            </div>
            <div class="building-btn battery" data-type="battery">
                <span class="icon">🔋</span>
                <span class="label">电池</span>
                <span class="price">$800</span>
            </div>
            <div class="building-btn wind" data-type="wind">
                <span class="icon">💨</span>
                <span class="label">风力</span>
                <span class="price">$2000</span>
            </div>
            <div class="building-btn solar" data-type="solar">
                <span class="icon">☀️</span>
                <span class="label">太阳能</span>
                <span class="price">$2500</span>
            </div>
            <div class="building-btn tower" data-type="tower">
                <span class="icon">🗼</span>
                <span class="label">电塔</span>
                <span class="price">$100</span>
            </div>
            <div class="building-btn repair" data-type="repair">
                <span class="icon">🔧</span>
                <span class="label">维修站</span>
                <span class="price">$2000</span>
            </div>
            <div class="building-btn dispatch" data-type="dispatch">
                <span class="icon">🎛️</span>
                <span class="label">调度中心</span>
                <span class="price">$3500</span>
            </div>
            <div class="building-btn energystorage" data-type="energystorage">
                <span class="icon">⚡</span>
                <span class="label">储能站</span>
                <span class="price">$4000</span>
            </div>
        </div>
        <div class="game-controls">
            <button class="control-btn" id="save-btn" title="保存游戏">💾</button>
            <button class="control-btn" id="load-btn" title="读取游戏">📂</button>
            <button class="control-btn" id="share-btn" title="分享游戏">🔗</button>
            <button class="control-btn" id="check-btn" title="系统检测">🔍</button>
            <button class="control-btn" id="snapshot-btn" title="截图分享">📷</button>
            <button class="control-btn" id="records-btn" title="排行榜">🏆</button>
        </div>
        <div class="speed-controls">
            <button class="speed-btn">⏸</button>
            <button class="speed-btn">.5x</button>
            <button class="speed-btn active">1x</button>
            <button class="speed-btn">2x</button>
        </div>
    </footer>

    <script type="module" src="src/game.js"></script>
</body>
</html>