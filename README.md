# Neon Grid: Drag & Drop 游戏玩法分析
该游戏是一款**电力网格建设与管理类模拟经营游戏**，核心围绕电力供应、资源管理和电网维护展开，融合了策略规划、资源分配和实时操作的玩法，以下是详细拆解：

## 一、核心目标
玩家需要建设并维护电力网格，为不断生成的居民建筑、工厂、商业建筑提供稳定电力供应，同时管理资金、控制成本，避免电网过载/故障导致游戏失败。

### 关键失败条件
- 出现“愤怒的建筑”（无电力供应的建筑）数量达到阈值（`maxAngryHouses`），触发“系统故障（SYSTEM FAILURE）”，游戏结束；
- 电网严重过载、电厂过热等极端情况也会直接导致游戏失败。

## 二、核心玩法模块

### 1. 资源管理（经济系统）
#### （1）核心资源：资金（Money）
- **初始资金**：200美元（`initialMoney`）；
- **收入来源**：
  - 居民建筑（House）：每个提供1美元/秒收入（`incomePerHouse`）；
  - 工厂（Factory）：每个提供8美元/秒收入（`incomePerFactory`）；
  - 商业建筑（Commercial）：每个提供5美元/秒收入（`incomePerComm`）；
  - 基础补贴（`baseSubsidy`）：固定25美元/周期的基础收入。
- **支出项**：
  - 建筑建造成本：电厂1500美元、核电站6000美元、电池800美元、电塔/电线也有对应成本；
  - 建筑维护费：普通电厂10美元/周期（`upkeepPerPlant`）、核电站50美元/周期（`nuclearUpkeep`）；
  - 电线升级/建造成本（`costWirePerUnit`/`costUpgradeMult`）。

#### （2）经济结算
- 按固定周期（`economyTickRate`=1000ms，即1秒）结算收入/支出，实时更新“净收入（Net Income）”和资金显示；
- 建筑拆除仅返还10%成本（`refundRate`），需谨慎规划建造。

### 2. 电力设施建设
玩家可建造三类核心电力设施，需结合成本、产能、维护费做策略选择：

| 设施类型 | 成本   | 核心属性                          | 策略定位               |
|----------|--------|-----------------------------------|------------------------|
| 电厂（Plant） | 1500$  | 产能15单位（`plantCapacity`）、维护费10$/周期 | 初期核心，低成本低产能 |
| 核电站（Nuclear） | 6000$ | 产能60单位（`nuclearCapacity`）、维护费50$/周期 | 后期主力，高成本高产能 |
| 电池（Battery） | 800$  | 容量500单位、充电4单位/秒、放电6单位/秒 | 调峰填谷，应对用电高峰 |

#### 建造操作逻辑
- 点击底部对应建筑按钮（电厂/核电站/电池）进入“放置模式”；
- 在地图上点击左键确认放置，右键取消放置模式；
- 放置后需通过“电线/电塔”将发电设施与用电建筑连接，形成完整电网。

### 3. 电网搭建与维护
#### （1）电网连接规则
- 电线（Link）有长度限制（`maxWireLength`=300），超过则无法连接；
- 电线可“吸附”到电塔/建筑（`snapDistance`=40），便于精准连接；
- 电线有基础负载上限（`baseWireLoad`=5），升级后提升至15（`upgradedWireLoad`），过载会变红（`wireOverload`/`wireDanger`），最终故障。

#### （2）电网状态管理
- 实时监测电线负载：过载时触发“警报层（alarmOverlay）”闪烁，提示玩家升级/新增电线；
- 电厂有过热机制（`overheatSpeed`/`maxHeat`）：超负荷运行会升温，达到100（`maxHeat`）后故障；
- 电池的充放电逻辑：用电低谷时充电，高峰时放电，缓解电网压力。

### 4. 用电建筑生成与管理
不同类型用电建筑解锁条件和生成规则不同，需提前规划电力供应：

| 建筑类型 | 解锁条件       | 生成周期   | 电力负载       | 核心特点               |
|----------|----------------|------------|----------------|------------------------|
| 居民建筑 | 初始解锁       | 8秒/个     | 基础负载       | 数量多、负载低、解锁早 |
| 工厂     | 人口达30（`factoryUnlockPop`） | 90秒/个    | 固定5单位（`factoryLoad`） | 负载高、收入高         |
| 商业建筑 | 人口达60（`commUnlockPop`） | 45秒/个    | 2-3单位（峰谷波动） | 负载波动、中等收入     |

#### 核心挑战
- 建筑生成速度随游戏进程加快，需提前扩容电网；
- 工厂/商业建筑的高负载/波动负载易导致电网过载，需搭配电池调峰。

### 5. 视图与时间控制
#### （1）视图操作
- 放大/缩小/重置视图：适配不同规模电网的查看需求；
- 全屏模式：提升操作视野，适配移动端/大屏设备；
- 视角平移：通过鼠标拖拽/触摸滑动移动地图，查看全局电网。

#### （2）时间流速控制
- 支持4档速度：暂停（0x）、0.5x、1x（默认）、2x；
- 加速模式下建筑生成、经济结算、电力消耗均加快，难度提升。

### 6. 游戏反馈与辅助系统
#### （1）系统消息（system-msg）
- 实时提示操作状态（如“放置电厂模式”）、故障预警（过载/过热）、收入变化；
- 不同状态有颜色标识：正常（青色）、警告（红色）、成功（绿色）。

#### （2）统计面板（stats-group）
- 实时显示核心数据：资金、收入/秒、电力覆盖百分比、人口（建筑总数）；
- 数据变化直观反馈运营效果，辅助玩家决策。

#### （3）游戏回放（Replay）
- 游戏结束后自动生成“时间回放”，可通过滑块查看故障前的电网状态；
- 回放界面展示各建筑/电线的状态（供电/断电/过载），便于玩家复盘失败原因。

## 三、玩法策略建议
1. **初期规划**：优先建造普通电厂，覆盖居民建筑，积累资金；
2. **中期扩容**：人口达30/60前，提前新增/升级电线，准备工厂/商业建筑的电力需求；
3. **后期优化**：替换部分普通电厂为核电站（提升产能），搭配电池应对峰谷负载；
4. **风险控制**：避免单一线路承载过高负载，分散电网压力；定期检查电线/电厂状态，及时升级/新增设施。

## 四、交互与适配
- 支持鼠标+键盘（Shift键触发高压模式）、触摸操作（移动端适配）；
- 移动端优化：缩小按钮尺寸、横向滚动工具栏、适配全屏触摸操作；
- 视觉反馈：不同状态的建筑/电线有专属颜色（如供电的房子为绿色，过载电线为橙色），便于快速识别问题。

## 欢迎大家创建PR为这个游戏添砖加瓦！
- 点击 [这里](https://github.com/liujianbo2013/smail-dianwang/fork) fork这个项目，然后修改代码，就可以提交啦！
